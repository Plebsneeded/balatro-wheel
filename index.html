<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balatro Deck Chooser</title>
    <style>
        /* CSS Styles */
        body {
            background-color: #e0e0e0;
            background-image: radial-gradient(#d0d0d0 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            color: #333;
        }

        h1 {
            margin: 0;
            font-size: 1.2rem;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        h2 {
            margin: 5px 0 20px 0;
            font-size: 2.5rem;
            font-weight: 800;
            color: #ccc;
            text-shadow: 1px 1px 0 #fff;
        }

        .wheel-container {
            position: relative;
            width: 350px;
            height: 350px;
            /* Shadow for depth */
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.2));
        }

        canvas {
            width: 100%;
            height: 100%;
            transform: rotate(0deg);
            transition: transform 4s cubic-bezier(0.1, 0, 0.2, 1);
            border-radius: 50%;
            border: 8px solid rgba(255,255,255,0.4);
        }

        .spinner-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background-color: #000;
            color: white;
            border-radius: 50%;
            border: 4px solid white;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        /* The Triangle Pointer */
        .pointer {
            position: absolute;
            top: -15px; /* Adjust to sit on top of the button */
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 25px solid #000;
            z-index: 11;
        }

        .result-modal {
            margin-top: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            min-height: 2rem;
            text-align: center;
        }

    </style>
</head>
<body>

    <h1>Balatro Deck Chooser</h1>
    <h2>Spin the wheel</h2>

    <div class="wheel-container">
        <div class="pointer"></div>
        <button class="spinner-btn" onclick="spinWheel()">Spin</button>
        <canvas id="wheelCanvas" width="500" height="500"></canvas>
    </div>

    <div class="result-modal" id="resultText"></div>

    <script>
        // Data Setup
        // Using approximate colors from your image for authenticity
        const decks = [
            { name: "Red Deck", color: "#3a3a3a", text: "#fff" },
            { name: "Blue Deck", color: "#4d7c8a", text: "#fff" },
            { name: "Yellow Deck", color: "#f0f0f0", text: "#333" },
            { name: "Green Deck", color: "#d9d9d9", text: "#333" },
            { name: "Black Deck", color: "#2f4858", text: "#fff" },
            { name: "Magic Deck", color: "#333333", text: "#fff" },
            { name: "Nebula Deck", color: "#4d7c8a", text: "#fff" },
            { name: "Ghost Deck", color: "#ffffff", text: "#000" },
            { name: "Abandoned Deck", color: "#d0d0d0", text: "#333" },
            { name: "Checkered Deck", color: "#2f4858", text: "#fff" },
            { name: "Zodiac Deck", color: "#333333", text: "#fff" },
            { name: "Painted Deck", color: "#4d7c8a", text: "#fff" },
            { name: "Anaglyph Deck", color: "#ffffff", text: "#000" },
            { name: "Plasma Deck", color: "#d9d9d9", text: "#333" },
            { name: "Erratic Deck", color: "#2f4858", text: "#fff" }
        ];

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const resultText = document.getElementById('resultText');
        
        let currentRotation = 0;
        let isSpinning = false;

        // Draw the Wheel
        function drawWheel() {
            const numSegments = decks.length;
            const arcSize = (2 * Math.PI) / numSegments;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2;

            decks.forEach((deck, i) => {
                const angle = i * arcSize;

                // Draw Slice
                ctx.beginPath();
                ctx.fillStyle = deck.color;
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                ctx.lineTo(centerX, centerY);
                ctx.fill();

                // Draw Text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arcSize / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = deck.text;
                ctx.font = "bold 24px Arial";
                ctx.fillText(deck.name, radius - 20, 10);
                ctx.restore();
            });
        }

        // Spin Logic
        function spinWheel() {
            if (isSpinning) return;
            
            isSpinning = true;
            resultText.innerText = "Spinning...";
            
            // Calculate a random spin:
            // 360 * 5 (at least 5 full spins) + random segment
            const randomDegree = Math.floor(Math.random() * 360) + 1800; 
            
            // Update the CSS transform for smooth animation
            currentRotation += randomDegree;
            canvas.style.transform = `rotate(-${currentRotation}deg)`;

            // Wait for animation to finish (4 seconds matches CSS transition)
            setTimeout(() => {
                isSpinning = false;
                determineWinner(currentRotation);
            }, 4000);
        }

        function determineWinner(rotation) {
            // Normalize rotation to 0-360
            const actualRotation = rotation % 360;
            const sliceSize = 360 / decks.length;
            
            // The pointer is at the TOP (270 degrees in canvas terms, or index 0 if we align correctly)
            // However, since we rotated the CANVAS negatively, we calculate which index is now at the top.
            // Pointer is static at the top.
            
            const winningIndex = Math.floor(actualRotation / sliceSize);
            
            // Due to the way the arc is drawn (clockwise) and rotated (counter-clockwise),
            // we have to be careful with the index math.
            // Simple visual check logic:
            // If we rotated 10 degrees, the slice at index 0 moved left. 
            // The slice at index [length-1] would come under the pointer.
            // Let's use a robust lookup based on the remainder:
            
            // Calculate index wrapping
            let index = (decks.length - Math.floor((actualRotation + 90) / sliceSize)) % decks.length;
            if (index < 0) index += decks.length;

            // In the image, the pointer is technically pointing slightly to the right of vertical,
            // but for code simplicity, we assume 12 o'clock (90 degrees offset in canvas math).
            
            // Corrected Math for 12 o'clock pointer:
            const segmentAngle = 360 / decks.length;
            const offsetRotation = (actualRotation + 90) % 360; // +90 because 0 is usually 3 o'clock
            const winningIndexCalc = Math.floor((360 - offsetRotation) / segmentAngle) % decks.length;
            
            // Let's define the specific deck
            const winner = decks[winningIndexCalc];
            
            resultText.innerText = `Selected: ${winner.name}`;
            resultText.style.color = winner.color === '#ffffff' ? '#333' : winner.color;
        }

        // Initial Draw
        drawWheel();

    </script>
</body>
</html>
